<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Dylan&#39;s Blog</title>
  <subtitle>每天进步一点点</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://kdylan.me/"/>
  <updated>2016-12-13T04:14:01.000Z</updated>
  <id>http://kdylan.me/</id>
  
  <author>
    <name>Dylan</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>mongoDB 用户权限控制</title>
    <link href="http://kdylan.me/2016/12/11/mongodb-auth/"/>
    <id>http://kdylan.me/2016/12/11/mongodb-auth/</id>
    <published>2016-12-11T04:13:53.000Z</published>
    <updated>2016-12-13T04:14:01.000Z</updated>
    
    <content type="html"><![CDATA[<p>最近打算把 <a href="https://github.com/k-dylan/easyclub/" target="_blank" rel="external">EasyClub</a> 部署到vps上,由于以前一直都是在本地测试状态下,mongodb连接没有采用auth,为了部署启用auth折腾了大半天,现在记录下操作步骤.</p>
<ol>
<li><p>首先不加<code>-auth</code>参数,启动 mongoDB:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mongod <span class="_">-f</span> ~/.mongodb.conf</div></pre></td></tr></table></figure>
<a id="more"></a>
</li>
<li><p>首先需要添加一个 <code>userAdminAnyDatabase</code> 用户,这是一个能够管理所有用户的的用户, 类似于超级管理员吧</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 打开mongo shell:</span></div><div class="line">mongo </div><div class="line"><span class="comment"># 添加管理帐号</span></div><div class="line">use admin  <span class="comment"># 先进入admin表</span></div><div class="line">db.createUser(&#123;</div><div class="line">  user: <span class="string">'dylan'</span>,</div><div class="line">  <span class="built_in">pwd</span>: <span class="string">'123456'</span>,</div><div class="line">  roles: [ &#123; role: <span class="string">"userAdminAnyDatabase"</span>, db: <span class="string">"admin"</span> &#125; ]</div><div class="line">&#125;)</div><div class="line"><span class="comment"># 查看用户是否创建成功</span></div><div class="line">show users</div><div class="line"><span class="comment"># 输出以下内容表示添加成功 </span></div><div class="line">&#123;</div><div class="line">  <span class="string">"_id"</span> : <span class="string">"admin.dylan"</span>,</div><div class="line">  <span class="string">"user"</span> : <span class="string">"dylan"</span>,</div><div class="line">  <span class="string">"db"</span> : <span class="string">"admin"</span>,</div><div class="line">  <span class="string">"roles"</span> : [</div><div class="line">    &#123;</div><div class="line">      <span class="string">"role"</span> : <span class="string">"userAdminAnyDatabase"</span>,</div><div class="line">      <span class="string">"db"</span> : <span class="string">"admin"</span></div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>重新打开mongodb,这次启用<code>-auth</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mongod -auth <span class="_">-f</span> ~/.mongodb.conf</div></pre></td></tr></table></figure>
</li>
<li><p>验证用户登录</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">mongo</div><div class="line"><span class="comment"># 注意: 这里要验证刚才创建的用户,必须要先切换到admin库</span></div><div class="line">use admin</div><div class="line">show dbs </div><div class="line"><span class="comment"># 这里会报错</span></div><div class="line">2016-12-11T13:11:01.981+0800 E QUERY    [thread1] Error: listDatabases failed:&#123;</div><div class="line">  <span class="string">"ok"</span> : 0,</div><div class="line">  <span class="string">"errmsg"</span> : <span class="string">"not authorized on admin to execute command &#123; listDatabases: 1.0 &#125;"</span>,</div><div class="line">  <span class="string">"code"</span> : 13</div><div class="line">&#125; :</div><div class="line">_getErrorWithCode@src/mongo/shell/utils.js:23:13</div><div class="line">Mongo.prototype.getDBs@src/mongo/shell/mongo.js:53:1</div><div class="line">shellHelper.show@src/mongo/shell/utils.js:700:19</div><div class="line">shellHelper@src/mongo/shell/utils.js:594:15</div><div class="line">@(shellhelp2):1:1</div><div class="line"></div><div class="line"><span class="comment"># 验证用户</span></div><div class="line">db.auth(<span class="string">'dylan'</span>, <span class="string">'123456'</span>)</div><div class="line">1 <span class="comment"># 输出1 表示验证成功</span></div><div class="line"><span class="comment"># 再次执行 </span></div><div class="line">show dbs </div><div class="line"><span class="comment"># 这次就会列出所有数据库</span></div></pre></td></tr></table></figure>
</li>
<li><p>为数据库添加管理用户</p>
<blockquote>
<p>注意: 上面添加的dylan用户只有管理用户的权限,是不能管理数据库的,而管理数据库的用户都是跟这数据库的,也就是说要先进入数据库,然后为数据库单独创建用户</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 切换到要添加用户的数据库中</span></div><div class="line">use easyclub</div><div class="line">db.createUser(&#123;</div><div class="line">  user: <span class="string">'easy'</span>,</div><div class="line">  <span class="built_in">pwd</span>: <span class="string">'123456'</span>,</div><div class="line">  roles: [ &#123; role: <span class="string">"readWrite"</span>, db: <span class="string">"easyclub"</span> &#125; ]</div><div class="line">&#125;)</div><div class="line"><span class="comment"># 查看刚才创建的用户</span></div><div class="line">show users</div></pre></td></tr></table></figure>
</li>
<li><p>验证创建的用户</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">use</span> easyclub</div><div class="line">show collections</div><div class="line"># 报错</div><div class="line">2016-12-11T13:17:46.602+0800 <span class="keyword">E</span> <span class="keyword">QUERY</span>    [thread1] <span class="keyword">Error</span>: listCollections failed: &#123;</div><div class="line">  <span class="string">"ok"</span> : 0,</div><div class="line">  <span class="string">"errmsg"</span> : <span class="string">"not authorized on easyclub to execute command &#123; listCollections: 1.0, filter: &#123;&#125; &#125;"</span>,</div><div class="line">  <span class="string">"code"</span> : 13</div><div class="line">&#125; :</div><div class="line">_getErrorWithCode@src/mongo/<span class="keyword">shell</span>/utils.js:23:13</div><div class="line"><span class="keyword">DB</span>.prototype._getCollectionInfosCommand@src/mongo/<span class="keyword">shell</span>/<span class="keyword">db</span>.js:746:1</div><div class="line"><span class="keyword">DB</span>.prototype.getCollectionInfos@src/mongo/<span class="keyword">shell</span>/<span class="keyword">db</span>.js:758:15</div><div class="line"><span class="keyword">DB</span>.prototype.getCollectionNames@src/mongo/<span class="keyword">shell</span>/<span class="keyword">db</span>.js:769:12</div><div class="line">shellHelper.show@src/mongo/<span class="keyword">shell</span>/utils.js:695:9</div><div class="line">shellHelper@src/mongo/<span class="keyword">shell</span>/utils.js:594:15</div><div class="line">@(shellhelp2):1:1</div><div class="line"></div><div class="line"># 验证</div><div class="line"><span class="keyword">db</span>.auth('easy','123456') # 返回1 表示验证成功</div><div class="line"></div><div class="line">show collections</div><div class="line">replies</div><div class="line">topics</div><div class="line">users</div></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>添加用户时的 role 有多种选项,具体可以查看这里:<a href="https://docs.mongodb.com/manual/reference/built-in-roles/" target="_blank" rel="external">https://docs.mongodb.com/manual/reference/built-in-roles/</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近打算把 &lt;a href=&quot;https://github.com/k-dylan/easyclub/&quot;&gt;EasyClub&lt;/a&gt; 部署到vps上,由于以前一直都是在本地测试状态下,mongodb连接没有采用auth,为了部署启用auth折腾了大半天,现在记录下操作步骤.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;首先不加&lt;code&gt;-auth&lt;/code&gt;参数,启动 mongoDB:&lt;/p&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mongod &lt;span class=&quot;_&quot;&gt;-f&lt;/span&gt; ~/.mongodb.conf&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Node" scheme="http://kdylan.me/categories/Node/"/>
    
    
      <category term="mongodb" scheme="http://kdylan.me/tags/mongodb/"/>
    
  </entry>
  
  <entry>
    <title>为github Pages绑定顶级域名</title>
    <link href="http://kdylan.me/2016/11/16/guthubPagebinddomain/"/>
    <id>http://kdylan.me/2016/11/16/guthubPagebinddomain/</id>
    <published>2016-11-15T16:13:53.000Z</published>
    <updated>2016-11-15T04:05:19.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="今天把自己新买的域名-kdylan-me-与Github-Pages进行了绑定，以后就可以通过-kdylan-me-来访问博客啦！下面记录一下绑定的过程"><a href="#今天把自己新买的域名-kdylan-me-与Github-Pages进行了绑定，以后就可以通过-kdylan-me-来访问博客啦！下面记录一下绑定的过程" class="headerlink" title="今天把自己新买的域名 kdylan.me 与Github Pages进行了绑定，以后就可以通过 kdylan.me 来访问博客啦！下面记录一下绑定的过程"></a>今天把自己新买的域名 <code>kdylan.me</code> 与Github Pages进行了绑定，以后就可以通过 <a href="http://kdylan.me/">kdylan.me</a> 来访问博客啦！下面记录一下绑定的过程</h2><ol>
<li>创建<code>CNAME</code>文件<br>在网站项目repo的根目录添加<code>CNAME</code>文件，注意必须是大写，不要扩展名。然后在里面写上网址，也不需要http以及www；<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kdylan.<span class="keyword">me</span></div></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>由于是本站是采用 <code>hexo</code> 搭建而成，如果直接在github网页中添加此文件，那么下次<code>hexo g -d</code>的时候就会删除此文件，所以要把该文件创建到项目的<code>source</code>文件夹根目录，那么下次<code>hexo g -d</code>的时候，就会把该文件也生成到<code>repo</code>中；</p>
</blockquote>
<ol>
<li>添加域名解析 </li>
</ol>
<ul>
<li>首先获取域名IP，打开电脑命令行，输入<code>ping k-dylan.github.io</code> 得到IP；</li>
<li>在域名管理中添加两个A解析分别是<code>@</code>和<code>www</code>,IP地址填刚刚查询到的IP</li>
</ul>
<p>最后等域名解析完成后就可以使用顶级域名访问网站啦！！</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;今天把自己新买的域名-kdylan-me-与Github-Pages进行了绑定，以后就可以通过-kdylan-me-来访问博客啦！下面记录一下绑定的过程&quot;&gt;&lt;a href=&quot;#今天把自己新买的域名-kdylan-me-与Github-Pages进行了绑定，以后就可
    
    </summary>
    
      <category term="Node" scheme="http://kdylan.me/categories/Node/"/>
    
    
      <category term="github" scheme="http://kdylan.me/tags/github/"/>
    
  </entry>
  
  <entry>
    <title>将项目web目录部署到gh-pages分支</title>
    <link href="http://kdylan.me/2016/10/19/subfolder-githubPages/"/>
    <id>http://kdylan.me/2016/10/19/subfolder-githubPages/</id>
    <published>2016-10-19T05:13:53.000Z</published>
    <updated>2016-10-19T13:45:04.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>在写icon-css项目的时候，需要部署一个预览页面，一般情况下可以采用github的<code>gh-pages</code>分支制作GitHub Pages，但是同一个项目里面既有源代码又预览页面文件，并不希望将源代码也添加到<code>gh-pages</code>分支中。这时就可以使用<code>git subtree</code> 功能</p>
<h2 id="什么是-git-subtree"><a href="#什么是-git-subtree" class="headerlink" title="什么是 git subtree"></a>什么是 git subtree</h2><p><code>git subtree</code> 是一条git子命令，可以在多个git项目之间双向同步子项目，简单的说就是：可以在一个项目中引用另外一个项目仓库中的代码<br><a id="more"></a></p>
<h2 id="git-subtree-如何使用"><a href="#git-subtree-如何使用" class="headerlink" title="git subtree 如何使用"></a>git subtree 如何使用</h2><p>初始化子项目<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git subtree add --prefix=用来存放子项目的文件夹 子项目库地址 分支</div><div class="line">// 运行后会自动把子项目分支中的代码下载到指定的文件夹中</div></pre></td></tr></table></figure></p>
<p>提交更改到子项目<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git subtree push --prefix=用来存放子项目的文件夹 子项目库地址 分支</div></pre></td></tr></table></figure></p>
<p>更新子项目新的代码到父项目<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git subtree pull --prefix=用来存放子项目的文件夹 子项目库地址 分支</div></pre></td></tr></table></figure></p>
<h2 id="部署-gh-pages-分支"><a href="#部署-gh-pages-分支" class="headerlink" title="部署 gh-pages 分支"></a>部署 gh-pages 分支</h2><p>看到这里，应该明白怎么做了吧，只要把<code>gh-pages</code>分支当做一个子项目，运行以下命令，就可以把web目录单独部署到<code>gh-pages</code>分支啦<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git subtree push --prefix dist origin gh-pages</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;需求&quot;&gt;&lt;a href=&quot;#需求&quot; class=&quot;headerlink&quot; title=&quot;需求&quot;&gt;&lt;/a&gt;需求&lt;/h2&gt;&lt;p&gt;在写icon-css项目的时候，需要部署一个预览页面，一般情况下可以采用github的&lt;code&gt;gh-pages&lt;/code&gt;分支制作GitHub Pages，但是同一个项目里面既有源代码又预览页面文件，并不希望将源代码也添加到&lt;code&gt;gh-pages&lt;/code&gt;分支中。这时就可以使用&lt;code&gt;git subtree&lt;/code&gt; 功能&lt;/p&gt;
&lt;h2 id=&quot;什么是-git-subtree&quot;&gt;&lt;a href=&quot;#什么是-git-subtree&quot; class=&quot;headerlink&quot; title=&quot;什么是 git subtree&quot;&gt;&lt;/a&gt;什么是 git subtree&lt;/h2&gt;&lt;p&gt;&lt;code&gt;git subtree&lt;/code&gt; 是一条git子命令，可以在多个git项目之间双向同步子项目，简单的说就是：可以在一个项目中引用另外一个项目仓库中的代码&lt;br&gt;
    
    </summary>
    
      <category term="git" scheme="http://kdylan.me/categories/git/"/>
    
    
      <category term="git" scheme="http://kdylan.me/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>基于hash和pushState的网页前端路由实现</title>
    <link href="http://kdylan.me/2016/05/21/hash-router/"/>
    <id>http://kdylan.me/2016/05/21/hash-router/</id>
    <published>2016-05-21T12:58:53.000Z</published>
    <updated>2016-09-30T14:20:57.000Z</updated>
    
    <content type="html"><![CDATA[<p>现在单页面应用是越来越流行了，而路由则是这种程序的基础，比如<code>vue-router</code>、<code>angular-router</code>等路由组件，今天我们来实现一个简单的路由类。</p>
<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><ul>
<li>支持hashURL，例如：<a href="http://test.com#/path" target="_blank" rel="external">http://test.com#/path</a>    </li>
<li>兼容History Api<a id="more"></a>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2>单页面应用需要在页面不刷新的情况下，通过更改地址栏url实现不同路由的切换，有两个api可以使用：</li>
<li>采用 <code>location.hash</code> 实现hash(#号)URL路由判断</li>
<li>采用 HTML5中的 <code>history.pushState()</code> 方法，<a href="https://developer.mozilla.org/zh-CN/docs/DOM/Manipulating_the_browser_history" target="_blank" rel="external">详细说明</a>;<blockquote>
<p>两种方式各有特点，第一个兼容性较好，可以在各种浏览器中运行，但是URL中会有一个<code>#</code>,看起来不好看，第一个是HTML5属性，只能在现代浏览器中运行；</p>
</blockquote>
</li>
</ul>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><h3 id="配置模式"><a href="#配置模式" class="headerlink" title="配置模式"></a>配置模式</h3><p>配置路由模式，分为两种 <code>hash</code> 和 <code>history</code>，当浏览器不支持 <code>history</code>时，即使设置为 <code>histroy</code> 模式，仍然使用 <code>hash</code> 模式。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.mode = options &amp;&amp; options.mode == <span class="string">'history'</span> </div><div class="line">                &amp;&amp;  !!(history.pushState) ? <span class="string">'history'</span> : <span class="string">'hash'</span>;</div><div class="line">                </div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="路由规则存储"><a href="#路由规则存储" class="headerlink" title="路由规则存储"></a>路由规则存储</h3><p>使用一个数组保存路由规则，每条路由规则对象有四个属性<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> route = &#123;</div><div class="line">    <span class="attr">reg</span>: <span class="keyword">new</span> <span class="built_in">RegExp</span>(), <span class="comment">// 路由匹配对象，通过_compile函数解析后生成</span></div><div class="line">    paramsName: [], <span class="comment">// 路由参数数组，保存参数名</span></div><div class="line">    name: <span class="string">'name'</span>, <span class="comment">// 路由名称</span></div><div class="line">    hander: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125; <span class="comment">// 路由执行函数</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="添加路由"><a href="#添加路由" class="headerlink" title="添加路由"></a>添加路由</h3><p>就是将定义的路由对象添加到routers数组中<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params">path, name, hander</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> name === <span class="string">'function'</span>)&#123;</div><div class="line">        hander = name;</div><div class="line">        name = path;</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">var</span> route = <span class="keyword">this</span>._compile(path);</div><div class="line">    <span class="keyword">this</span>.routers.push(&#123;</div><div class="line">        <span class="attr">reg</span>: route.reg,</div><div class="line">        <span class="attr">paramsName</span>: route.paramsName,</div><div class="line">        <span class="attr">name</span>: name,</div><div class="line">        <span class="attr">hander</span>: hander</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="解析路由"><a href="#解析路由" class="headerlink" title="解析路由"></a>解析路由</h3><p>也就是将定义的路由规则转换为正则表达式，便于以后匹配路由;<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params">router</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> route = &#123;&#125;; <span class="comment">// 路由对象</span></div><div class="line">    </div><div class="line">    <span class="comment">// 将/post/:postid 转换为 /post/(\w+);</span></div><div class="line">    <span class="keyword">var</span> paramsReg = <span class="regexp">/:(\w+)/g</span>;</div><div class="line">    <span class="keyword">var</span> paramsMatch = router.match(paramsReg);</div><div class="line">    </div><div class="line">    <span class="keyword">if</span>(paramsMatch) &#123;</div><div class="line">        </div><div class="line">        route.paramsName = paramsMatch.map(<span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> name.replace(<span class="string">':'</span>,<span class="string">''</span>)</div><div class="line">        &#125;);</div><div class="line">        router = router.replace(<span class="regexp">/:(\w+)/g</span>, <span class="string">'(\\w+)'</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    route.reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>( <span class="string">'^'</span> + router + <span class="string">'$'</span>);</div><div class="line">    <span class="keyword">return</span> route;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="监听路由"><a href="#监听路由" class="headerlink" title="监听路由"></a>监听路由</h3><p>也就是绑定浏览器时间，在url改变时处理获取path匹配路由<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">    <span class="comment">// 绑定监听事件            </span></div><div class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.mode === <span class="string">'history'</span>)&#123;</div><div class="line">        <span class="keyword">this</span>._addEvent(<span class="built_in">window</span>, <span class="string">'popstate'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> path = location.pathname;</div><div class="line">            self._check(path);</div><div class="line">        &#125;);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">this</span>._addEvent(<span class="built_in">window</span>, <span class="string">'hashchange'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="comment">// location.hash默认返回的是带#号的hash，需要去掉#号</span></div><div class="line">            <span class="keyword">var</span> path = location.hash.replace(<span class="regexp">/^#/</span>,<span class="string">''</span>);</div><div class="line">            self._check(path);</div><div class="line">        &#125;);</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="匹配路由"><a href="#匹配路由" class="headerlink" title="匹配路由"></a>匹配路由</h3><p>循环路由数组，发现匹配的对象，则处理路由参数，并执行路由处理函数<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params">path</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> routers = <span class="keyword">this</span>.routers;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>,len = routers.length; i &lt; len; i++) &#123;</div><div class="line">        <span class="keyword">var</span> match = path.match(routers[i].reg);</div><div class="line">        <span class="comment">// 匹配成功</span></div><div class="line">        <span class="keyword">if</span>(match) &#123;</div><div class="line">            <span class="keyword">var</span> params = &#123;&#125;;</div><div class="line">            <span class="comment">// 组合参数</span></div><div class="line">            routers[i].paramsName &amp;&amp; routers[i].paramsName</div><div class="line">                .forEach(<span class="function"><span class="keyword">function</span> (<span class="params">name,index</span>) </span>&#123;</div><div class="line">                    params[name] = match[index + <span class="number">1</span>];</div><div class="line">                &#125;);</div><div class="line">            </div><div class="line">            routers[i].hander.call(&#123;&#125;, &#123;</div><div class="line">                <span class="attr">params</span>: params </div><div class="line">            &#125;);</div><div class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// 都不匹配时，如果有默认函数则执行</span></div><div class="line">    <span class="keyword">this</span>.defaultHander &amp;&amp; <span class="keyword">this</span>.defaultHander.call(&#123;&#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="最终代码"><a href="#最终代码" class="headerlink" title="最终代码"></a>最终代码</h3><p>基本上主要问题就这么多，最终代码已上传github</p>
<p><a href="https://github.com/k-dylan/SRouter" target="_blank" rel="external">github</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;现在单页面应用是越来越流行了，而路由则是这种程序的基础，比如&lt;code&gt;vue-router&lt;/code&gt;、&lt;code&gt;angular-router&lt;/code&gt;等路由组件，今天我们来实现一个简单的路由类。&lt;/p&gt;
&lt;h2 id=&quot;需求&quot;&gt;&lt;a href=&quot;#需求&quot; class=&quot;headerlink&quot; title=&quot;需求&quot;&gt;&lt;/a&gt;需求&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;支持hashURL，例如：&lt;a href=&quot;http://test.com#/path&quot;&gt;http://test.com#/path&lt;/a&gt;    &lt;/li&gt;
&lt;li&gt;兼容History Api
    
    </summary>
    
      <category term="javascript" scheme="http://kdylan.me/categories/javascript/"/>
    
    
      <category term="前端" scheme="http://kdylan.me/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="javascript" scheme="http://kdylan.me/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>js获取隐藏元素的实际宽和高</title>
    <link href="http://kdylan.me/2016/05/02/get-hidden-node-height/"/>
    <id>http://kdylan.me/2016/05/02/get-hidden-node-height/</id>
    <published>2016-05-02T04:51:45.000Z</published>
    <updated>2016-05-02T13:39:24.000Z</updated>
    
    <content type="html"><![CDATA[<p>我们通常都是使用 <code>Element.offsetHeight</code> 来获取一个节点的宽和高度的，在一般的使用中是没什么问题的。但是，如果节点的 <code>display</code> 属性为 <code>none</code>话，就获取不到实际的宽高了，获取到的数据就是0；<br><iframe scrolling="no" width="100%" height="300" src="http://jsfiddle.net/xyy7c7am/embedded/result,html,css,js/light" frameborder="0" allowfullscreen></iframe></p>
<blockquote>
<p>那如何才能获取到实际的宽高呢？<br><a id="more"></a></p>
</blockquote>
<p>由于节点为 <code>display:none</code>的情况下，浏览器是不渲染这个节点的，自然就获取不到节点的大小了，所以我们要想获取到这个节点的大小，首先就要让浏览器渲染这个节点，那么就要把 <code>display</code> 设置为 <code>block</code> ,获取到大小，再隐藏这个节点就行了。但是这样节点就显示隐藏，有时会造成浏览器闪屏，所以我们还需要用到另外一个属性 <code>visibility</code>, <code>visibility</code> 设置为 <code>hidden</code> 时，浏览器可以获取节点的大小，却不显示这个节点。</p>
<p>不过还有一个问题，如果设置为 <code>visibility：hidden</code> 的话，节点的位置是要空出来了，而且有可能会造成布局错乱。所以需要将节点从正常的文档流中脱离，即使用 <code>position:absolute</code>;</p>
<p>所以具体实现如下：</p>
<iframe scrolling="no" width="100%" height="300" src="http://jsfiddle.net/d95kks5k/embedded/result,html,css,js/light" frameborder="0" allowfullscreen></iframe>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;我们通常都是使用 &lt;code&gt;Element.offsetHeight&lt;/code&gt; 来获取一个节点的宽和高度的，在一般的使用中是没什么问题的。但是，如果节点的 &lt;code&gt;display&lt;/code&gt; 属性为 &lt;code&gt;none&lt;/code&gt;话，就获取不到实际的宽高了，获取到的数据就是0；&lt;br&gt;&lt;iframe scrolling=&quot;no&quot; width=&quot;100%&quot; height=&quot;300&quot; src=&quot;http://jsfiddle.net/xyy7c7am/embedded/result,html,css,js/light&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;那如何才能获取到实际的宽高呢？&lt;br&gt;
    
    </summary>
    
      <category term="javascript" scheme="http://kdylan.me/categories/javascript/"/>
    
    
      <category term="前端" scheme="http://kdylan.me/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="javascript" scheme="http://kdylan.me/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>CSS3中使用transition过渡动画高度自适应的问题</title>
    <link href="http://kdylan.me/2016/05/01/css-transition-auto/"/>
    <id>http://kdylan.me/2016/05/01/css-transition-auto/</id>
    <published>2016-05-01T03:19:51.000Z</published>
    <updated>2016-05-01T14:36:37.000Z</updated>
    
    <content type="html"><![CDATA[<p>最近在做一个项目的时候，需要为一个列表添加个slideDown的动画，容器的高度是不确定的，如果用jquery实现的话很简单：<br><a id="more"></a><br><iframe scrolling="no" width="100%" height="300" src="http://jsfiddle.net/dhwfmbmx/embedded/result,html,css,js/light" frameborder="0" allowfullscreen></iframe></p>
<p>而用CSS3实现的话，由于高度的不确定，而 <code>transtion</code> 是需要具体的树枝，所以设置 <code>height:auto</code> 是无法实现效果的，可以通过 <code>max-height</code> 这个属性间接的实现这么个效果，css样式是这样的：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.bd</span> &#123; </div><div class="line">    <span class="attribute">display</span>:none;</div><div class="line">    <span class="attribute">max-height</span>:<span class="number">0</span>;</div><div class="line">    <span class="attribute">overflow</span>:hidden;</div><div class="line">    <span class="attribute">transition</span>: all .<span class="number">6s</span> ease-out;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.show</span> &#123;</div><div class="line">    <span class="attribute">max-height</span>: <span class="number">200px</span>;</div><div class="line">    <span class="attribute">transition-timing-function</span>: ease-in;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>具体效果：<br><iframe scrolling="no" width="100%" height="300" src="http://jsfiddle.net/w1mw829k/embedded/result,html,css,js/light" frameborder="0" allowfullscreen></iframe></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近在做一个项目的时候，需要为一个列表添加个slideDown的动画，容器的高度是不确定的，如果用jquery实现的话很简单：&lt;br&gt;
    
    </summary>
    
      <category term="css" scheme="http://kdylan.me/categories/css/"/>
    
    
      <category term="前端" scheme="http://kdylan.me/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="css" scheme="http://kdylan.me/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>Hexo部署到Github上文件夹的大小写问题</title>
    <link href="http://kdylan.me/2016/02/19/hexo-deploy-low-dir/"/>
    <id>http://kdylan.me/2016/02/19/hexo-deploy-low-dir/</id>
    <published>2016-02-19T15:59:23.000Z</published>
    <updated>2016-02-19T16:21:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>最近在倒腾使用<code>hexo</code>在github上搭建个博客，发现一个挺有意思的问题：</p>
<p>在写文章的时候，有个分类名开始起名为：<code>http</code>，后来感觉小写不好看，就给改成了大写<code>HTTP</code>，提交到github上之后就发现出问题了，http分类页面变成404了！</p>
<p>经过排查问题发现github上的目录名为<code>http</code>，而分类请求的目录名为<code>HTTP</code>，而Github Pages是区分大小写的，所以造成找不到文件出现404错误！</p>
<p>通过检查hexo生成的<code>.deploy_git</code>文件夹内的文件名是大写的，而使用<code>hexo d</code>提交到github上之后的目录还是小写，这是因为git默认是忽略大小写的！</p>
<h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><ol>
<li>删除<code>.deploy_git</code>目录</li>
<li>再次运行<code>hexo d</code>提交，hexo会重置git仓库，并重新生成所有文件!</li>
<li>打开github查看，问题解决！</li>
</ol>
<blockquote>
<p>可以使用下面语句设置git大小写敏感，防止下次出现这样的问题：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git config core.ignorecase <span class="literal">false</span></div></pre></td></tr></table></figure></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近在倒腾使用&lt;code&gt;hexo&lt;/code&gt;在github上搭建个博客，发现一个挺有意思的问题：&lt;/p&gt;
&lt;p&gt;在写文章的时候，有个分类名开始起名为：&lt;code&gt;http&lt;/code&gt;，后来感觉小写不好看，就给改成了大写&lt;code&gt;HTTP&lt;/code&gt;，提交到gith
    
    </summary>
    
      <category term="Node" scheme="http://kdylan.me/categories/Node/"/>
    
    
      <category term="Hexo" scheme="http://kdylan.me/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>express中使用ejs</title>
    <link href="http://kdylan.me/2016/02/17/express-ejs/"/>
    <id>http://kdylan.me/2016/02/17/express-ejs/</id>
    <published>2016-02-16T16:13:53.000Z</published>
    <updated>2016-02-19T15:49:57.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="1、使用express命令初始化项目"><a href="#1、使用express命令初始化项目" class="headerlink" title="1、使用express命令初始化项目"></a>1、使用express命令初始化项目</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ express -e ejs [后面可以添加项目名称，添加的话 会创建项目文件夹，不添加就在当前文件夹内]</div></pre></td></tr></table></figure>
<h3 id="2、启用ejs的layout模板"><a href="#2、启用ejs的layout模板" class="headerlink" title="2、启用ejs的layout模板"></a>2、启用ejs的layout模板</h3><p>express3以上默认把layout给去掉了，所以现在文件夹下没有layout.ejs文件</p>
<h4 id="安装express-partials"><a href="#安装express-partials" class="headerlink" title="安装express-partials"></a>安装express-partials</h4><p>在package.json里面的dependencies中添加 <code>&quot;express-partials&quot; : &quot;*&quot;</code> 。然后再项目目录下运行<code>npm install</code></p>
<h4 id="在项目中引用express-partials"><a href="#在项目中引用express-partials" class="headerlink" title="在项目中引用express-partials"></a>在项目中引用express-partials</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> partials = <span class="built_in">require</span>(<span class="string">'express-partials'</span>);</div><div class="line"><span class="comment">//在app.set('view engine', 'ejs'); 下面添加</span></div><div class="line">app.use(partials());</div></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="3、使用方法"><a href="#3、使用方法" class="headerlink" title="3、使用方法"></a>3、使用方法</h3><p>在需要引用模板的地方调用 layout:’模板名称’</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">app.get(<span class="string">'/reg'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123; </div><div class="line">    res.render(<span class="string">'reg'</span>, &#123; </div><div class="line">        <span class="attr">title</span>: <span class="string">'用户注册'</span>, </div><div class="line">        <span class="attr">layout</span>: <span class="string">'template'</span></div><div class="line">     &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;1、使用express命令初始化项目&quot;&gt;&lt;a href=&quot;#1、使用express命令初始化项目&quot; class=&quot;headerlink&quot; title=&quot;1、使用express命令初始化项目&quot;&gt;&lt;/a&gt;1、使用express命令初始化项目&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;$ express -e ejs [后面可以添加项目名称，添加的话 会创建项目文件夹，不添加就在当前文件夹内]&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;2、启用ejs的layout模板&quot;&gt;&lt;a href=&quot;#2、启用ejs的layout模板&quot; class=&quot;headerlink&quot; title=&quot;2、启用ejs的layout模板&quot;&gt;&lt;/a&gt;2、启用ejs的layout模板&lt;/h3&gt;&lt;p&gt;express3以上默认把layout给去掉了，所以现在文件夹下没有layout.ejs文件&lt;/p&gt;
&lt;h4 id=&quot;安装express-partials&quot;&gt;&lt;a href=&quot;#安装express-partials&quot; class=&quot;headerlink&quot; title=&quot;安装express-partials&quot;&gt;&lt;/a&gt;安装express-partials&lt;/h4&gt;&lt;p&gt;在package.json里面的dependencies中添加 &lt;code&gt;&amp;quot;express-partials&amp;quot; : &amp;quot;*&amp;quot;&lt;/code&gt; 。然后再项目目录下运行&lt;code&gt;npm install&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&quot;在项目中引用express-partials&quot;&gt;&lt;a href=&quot;#在项目中引用express-partials&quot; class=&quot;headerlink&quot; title=&quot;在项目中引用express-partials&quot;&gt;&lt;/a&gt;在项目中引用express-partials&lt;/h4&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; partials = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;express-partials&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//在app.set(&#39;view engine&#39;, &#39;ejs&#39;); 下面添加&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;app.use(partials());&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Node" scheme="http://kdylan.me/categories/Node/"/>
    
    
      <category term="Node" scheme="http://kdylan.me/tags/Node/"/>
    
  </entry>
  
  <entry>
    <title>Mac下Apache和php的配置</title>
    <link href="http://kdylan.me/2016/02/15/mac+apache+php/"/>
    <id>http://kdylan.me/2016/02/15/mac+apache+php/</id>
    <published>2016-02-15T03:19:51.000Z</published>
    <updated>2016-02-17T08:24:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>osX系统是默认自带的有php和apache的 </p>
</blockquote>
<h2 id="1、启动Apache"><a href="#1、启动Apache" class="headerlink" title="1、启动Apache"></a>1、启动Apache</h2><p>打开终端：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">开启apache命令：sudo apachectl start</div><div class="line">关闭apache命令：sudo apachectl stop</div><div class="line">重启apache命令：sudo apachectl restart</div></pre></td></tr></table></figure>
<p>启用apache后，可以直接在浏览器访问<code>http://localhost</code>，出现“<code>It works！</code>”表示运行正常。</p>
<ol>
<li><p>用户级的根目录是：<code>~Sites</code>，也就是站点目录。在 OS X Mountain Lion 中，这个目录可能没有，所以你需要手动建立一个同名目录。建立方式很简单，直接在终端中运行：<code>sudo mkdir Sites</code></p>
</li>
<li><p>建立”站点”文件夹之后，检查下面这个文件夹下面是不是有”<code>你的用户名.conf</code>”这个文件。</p>
</li>
</ol>
<p>如果没有，那么你需要创建一个，取名为“<code>dylan.conf</code>”，可以使用 vi 或者 nano 这两种编辑器之一来创建。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vi /etc/apache2/users/haibor.conf</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>创建之后将下面的这几行内容写到上面的 conf 文件中：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Directory</span> "/<span class="attr">Users</span>/<span class="attr">haibor</span>/<span class="attr">Sites</span>/"&gt;</span></div><div class="line">    Options Indexes MultiViews</div><div class="line">    AllowOverride All</div><div class="line">    Order allow,deny</div><div class="line">    Allow from all</div><div class="line"><span class="tag">&lt;/<span class="name">Directory</span>&gt;</span></div></pre></td></tr></table></figure>
<p>文件保存之后，给它赋予相应的权限：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chmod 755 /etc/apache2/users/haibor.conf</div></pre></td></tr></table></figure>
<p>接下来重启 Apache，以使该配置文件生效：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apachectl restart</div></pre></td></tr></table></figure>
<p>之后你就可以通过浏览器访问你的用户级目录网页了，你可以随便防个网页进去测试一下。根目录地址为：</p>
<p><a href="http://localhost/~haibor/" target="_blank" rel="external">http://localhost/~haibor/</a></p>
<blockquote>
<p>也可以更改根目录，但要记得给新文件夹设置，文件夹需要有执行权限x，设置了755就可以了：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir /Users/<span class="keyword">user</span>/workspace</div><div class="line">mod <span class="number">755</span> /<span class="keyword">User</span>/<span class="keyword">user</span>/workspace</div></pre></td></tr></table></figure>
<p><code>etc/apache2/httpd.conf</code>文件里的 <code>/Library/WebServer/Documents</code> 都替换成自己的路径，比如 <code>/User/user/workspace</code></p>
<p>重启Apache：<code>apachectl restart</code>，再次访问 <a href="http://localhost/" target="_blank" rel="external">http://localhost/</a> 即显示的是更改后的文件里的内容了。</p>
</blockquote>
<h2 id="二、开启-PHP"><a href="#二、开启-PHP" class="headerlink" title="二、开启 PHP"></a>二、开启 PHP</h2><p>OS X 中已经集成了 PHP 5.4.30 版本，需要手动开启。你可以用 <code>vi</code> 或者 <code>nano</code> 编辑器打开下面这个文件：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nano <span class="regexp">/etc/</span>apache2<span class="regexp">/httpd.conf</span></div></pre></td></tr></table></figure>
<p>然后按ctl+W进行查找，搜索”php”，第一条匹配的应该是下面这句代码：</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">LoadModule php5_module libexec/apache2/libphp5.so</div></pre></td></tr></table></figure>
<p>请将这句代码前面的#去掉，然后保存文件。</p>
<p>接下来再一次重启 Apache：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">sudo apachectl restart</span></div></pre></td></tr></table></figure>
<p>现在 PHP 应该已经开始工作了，你可以在用户级根目录下(~/Sites/)放一个PHP测试文件，代码如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> phpinfo(); <span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<h2 id="三、安装-MySQL"><a href="#三、安装-MySQL" class="headerlink" title="三、安装 MySQL"></a>三、安装 MySQL</h2><p>OS X 中并没有集成 Mysql，需要手动安装。你可以点击 <a href="http://dev.mysql.com/downloads/mysql/" target="_blank" rel="external">http://dev.mysql.com/downloads/mysql/</a> 去官网下载 MySQL 的安装包。</p>
<p>请下载 <code>Mac OS X 10.7 (x86, 64-bit).DMG Archive</code>  （如有更新版本，可下载）。</p>
<p>下载完DMG之后，双击你会提取出三个文件和一个 <code>ReadMe.txt</code> 文档。这三个文件分别是：</p>
<blockquote>
<p>mysql-5.6.15-osx10.7-x86_64.pkg<br>MySQLstartupitem.pkg<br>MySQL.PrefPane</p>
</blockquote>
<p>你需要逐一安装这三个文件，<code>MySQLStartupItem.pkg</code> 安装后，mysql会随系统启动而自启动，<code>MySQL.prefPane</code> 表示可以在系统偏好设置中看到mysql选项，还有一个就是mysql的安装项。</p>
<p>三个文件都安装完成之后，进入<code>系统偏好设置</code>，在面板的最下面你会看到一个 MySQL 的设置项，点击它之后就可以启动MySQL。</p>
<p>也可以通过命令开启mysql：<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo /usr/<span class="built_in">local</span>/mysql/support-<span class="built_in">files</span>/mysql.server <span class="built_in">start</span></div></pre></td></tr></table></figure></p>
<p>如果你想查看 MySQL 的版本，可以用下面这个命令：<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="regexp">/usr/</span>local<span class="regexp">/mysql/</span>bin<span class="regexp">/mysql -v</span></div></pre></td></tr></table></figure></p>
<p>运行上面这个命令之后，会直接从命令行中登录到 MySQL，输入命令 \q 即可退出。</p>
<p>到这里 MySQL 已经配置完成，并且可以运行。</p>
<blockquote>
<p>为了更加方便使用，最好再设置一下系统环境变量，也就是让 mysql 这个命令在任何路径都可以直接启动(不需要输入一长串的准确路径)。</p>
<p>设置环境变量也很方便，直接用命令(这里用 vi 编辑器举例)：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> vi .bash_profile</div></pre></td></tr></table></figure></p>
<p>如果没有这个文件，就要先创建一个<br>进入当前用户的home目录<br>输入<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> ~</div><div class="line">//创建.bash_profile</div><div class="line">touch .bash_profile</div></pre></td></tr></table></figure></p>
<p>然后按字母 i 进入编辑模式，将下面的这句代码贴进去：<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">export</span> PATH=<span class="string">"/usr/local/mysql/bin:<span class="variable">$PATH</span>"</span></div></pre></td></tr></table></figure></p>
<p>然后按 <code>esc</code> 退出编辑器，再输入 <code>:wq</code>(别忘了冒号)保存退出。当然你如果使用 <code>nano</code> 或者别的编辑器的话，操作方式跟这个可能不一样，反正意思就是将上面那句话写入到 <code>.bash_profile</code> 文件中。</p>
<p>接下来还要重新加载一下 <code>Shell</code> 以让上面的环境变量生效：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">source</span> ~/.bash_profile</div></pre></td></tr></table></figure></p>
<p>之后你就可以在终端的任意目录使用 mysql 命令了，你可以运行 <code>mysql -v</code>试试。</p>
<p>最后一步，安装好后默认的用户名是root，密码为空，你还应该给你的 MySQL 设置一个 <code>root</code> 用户密码，命令如下：<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">mysqladmin</span> -u root password <span class="string">'这里填你要设置的密码'</span></div></pre></td></tr></table></figure></p>
<p>(请记住密码一定要用半角单引号包起来)</p>
<p>上面的 mysqladmin 命令，我没有写完整路径。因为上面我们已经设置了环境变量，如果你没有设置环境变量的话，就需要用/usr/local/mysql/bin/mysqladmin <strong><em>**</em></strong> 来运行。</p>
</blockquote>
<h2 id="四、安装-phpMyAdmin-或-adminer"><a href="#四、安装-phpMyAdmin-或-adminer" class="headerlink" title="四、安装 phpMyAdmin 或 adminer"></a>四、安装 phpMyAdmin 或 adminer</h2><p>在安装 phpMyAdmin 之前，请首先修复 2002 socket 错误：<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo mkdir <span class="regexp">/var/my</span>sql</div><div class="line">sudo ln -s <span class="regexp">/tmp/my</span>sql.sock <span class="regexp">/var/my</span>sql<span class="regexp">/mysql.sock</span></div></pre></td></tr></table></figure></p>
<p>接着可以在 <code>phpMyAdmin</code> 官网下载安装包，推荐下载 <code>english.tar.gz</code>，也可以下载 <code>all-languages.tar.gz</code> 使用中文版，解压之后，将解压出来的文件夹改名为<code>phpmyadmin</code>，并放到上面建立的”站点”目录下(~/Sites)。</p>
<p>然后在 <code>phpmyadmin</code> 下建立一个 <code>config</code> 文件夹：<br>到这里就算完成了，接下来你就可以访问 <a href="http://localhost/~haibor/phpmyadmin/" target="_blank" rel="external">http://localhost/~haibor/phpmyadmin/</a> </p>
<p>来通过 <code>phpmysql</code> 管理你的数据库了。 </p>
<p>也可以使用 <code>adminer</code> 来管理，很方便的说，推荐相关文章 轻量级主流数据库Web端管理工具<code>Adminer</code>。</p>
<h2 id="五、设置虚拟主机"><a href="#五、设置虚拟主机" class="headerlink" title="五、设置虚拟主机"></a>五、设置虚拟主机</h2><p>配置 Apache 文件：<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo <span class="keyword">vi</span> /etc/apache2/httpd.<span class="keyword">conf</span></div></pre></td></tr></table></figure></p>
<p>在 <code>httpd.conf</code> 中找到 <code>#Include /private/etc/apache2/extra/httpd-vhosts.conf</code>，去掉前面的“＃”，“:wq!” 保存并退出。</p>
<p>重启 Apache：<code>sudo apachectl restart</code>。</p>
<p>配置虚拟主机文件 <code>httpd-vhost.conf</code></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vi <span class="regexp">/etc/</span>apache2<span class="regexp">/extra/</span>httpd-vhosts.conf</div></pre></td></tr></table></figure>
<p>实际上，这两个虚拟主机是不存在的，在没有配置任何其他虚拟主机时，可能会导致访问localhost时出现如下提示：</p>
<blockquote>
<p>Forbidden You don’t have permission to access /index.php on this server</p>
</blockquote>
<p>最简单的办法就是在它们每行前面加上#，注释掉就好了，这样既能参考又不导致其他问题。</p>
<h2 id="六、关于-php-ini"><a href="#六、关于-php-ini" class="headerlink" title="六、关于 php.ini"></a>六、关于 php.ini</h2><p>先复制一份 php.ini，然后就可以通过php.ini来配置各种PHP功能了。<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo cp <span class="regexp">/etc/</span>php.ini.<span class="keyword">default</span> <span class="regexp">/etc/</span>php.ini</div></pre></td></tr></table></figure></p>
<p>例如修改 <code>upload_max_filesize</code>、<code>memory_limit</code>、<code>post_max_size</code> 三项值，来调整PHP提交文件的最大值，比如<code>phpMyAdmin</code> 中导入数据的最大值。</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;osX系统是默认自带的有php和apache的 &lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;1、启动Apache&quot;&gt;&lt;a href=&quot;#1、启动Apache&quot; class=&quot;headerlink&quot; title=&quot;1、启动Apache&quot;&gt;&lt;/a&gt;1、启动Apache&lt;/h2&gt;&lt;p&gt;打开终端：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;开启apache命令：sudo apachectl start&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;关闭apache命令：sudo apachectl stop&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;重启apache命令：sudo apachectl restart&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;启用apache后，可以直接在浏览器访问&lt;code&gt;http://localhost&lt;/code&gt;，出现“&lt;code&gt;It works！&lt;/code&gt;”表示运行正常。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;用户级的根目录是：&lt;code&gt;~Sites&lt;/code&gt;，也就是站点目录。在 OS X Mountain Lion 中，这个目录可能没有，所以你需要手动建立一个同名目录。建立方式很简单，直接在终端中运行：&lt;code&gt;sudo mkdir Sites&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;建立”站点”文件夹之后，检查下面这个文件夹下面是不是有”&lt;code&gt;你的用户名.conf&lt;/code&gt;”这个文件。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;如果没有，那么你需要创建一个，取名为“&lt;code&gt;dylan.conf&lt;/code&gt;”，可以使用 vi 或者 nano 这两种编辑器之一来创建。&lt;/p&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;sudo vi /etc/apache2/users/haibor.conf&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="PHP" scheme="http://kdylan.me/categories/PHP/"/>
    
    
      <category term="PHP" scheme="http://kdylan.me/tags/PHP/"/>
    
      <category term="Mac" scheme="http://kdylan.me/tags/Mac/"/>
    
  </entry>
  
  <entry>
    <title>URI和URL的区别</title>
    <link href="http://kdylan.me/2016/02/07/URI%E5%92%8CURL%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
    <id>http://kdylan.me/2016/02/07/URI和URL的区别/</id>
    <published>2016-02-07T03:19:51.000Z</published>
    <updated>2016-02-19T15:50:05.000Z</updated>
    
    <content type="html"><![CDATA[<p>URI：是<code>uniform resource identifier</code>，统一资源标识符，用来唯一的标识一个资源；</p>
<p>URL: 是<code>uniform resource locator</code>，统一资源定位器，它是一种具体的URI；</p>
<blockquote>
<p>URL可以用来标识一个资源，而且还指明如何如何locator这个资源。<br>URI是一种抽象的，更高层次的概念定义统一资源标识，而URL则是具体的资源标识方式</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;URI：是&lt;code&gt;uniform resource identifier&lt;/code&gt;，统一资源标识符，用来唯一的标识一个资源；&lt;/p&gt;
&lt;p&gt;URL: 是&lt;code&gt;uniform resource locator&lt;/code&gt;，统一资源定位器，它是一种具体的URI；
    
    </summary>
    
      <category term="HTTP" scheme="http://kdylan.me/categories/HTTP/"/>
    
    
      <category term="前端" scheme="http://kdylan.me/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="url" scheme="http://kdylan.me/tags/url/"/>
    
  </entry>
  
</feed>
